#!/usr/bin/env python3
# -*- coding: utf-8 -*-

# This file is part of macchiato
#   https://github.com/fernandezfran/macchiato/
# Copyright (c) 2023, Francisco Fernandez
# License: MIT
#   https://github.com/fernandezfran/macchiato/blob/master/LICENSE

# ============================================================================
# IMPORTS
# ============================================================================

import os
import pathlib

import exma

import numpy as np

import pytest

# =============================================================================
# FIXTURES
# =============================================================================


@pytest.fixture()
def data_path():
    return pathlib.Path(
        os.path.join(os.path.abspath(os.path.dirname(__file__)), "test_data")
    )


@pytest.fixture()
def Li13Si64(data_path):
    traj = exma.read_xyz(data_path / "Li13Si64.xyz")
    traj[0].box = np.full(3, 11.510442)
    return {
        "trajectory": traj,
        "bonded": 1.0,
        "isolated": 0.0,
        "contributions": np.full(13, 18.0),
    }


@pytest.fixture()
def Li36Si64(data_path):
    traj = exma.read_xyz(data_path / "Li36Si64.xyz")
    traj[0].box = np.full(3, 12.304134)
    return {
        "trajectory": traj,
        "bonded": 1.0,
        "isolated": 0.0,
        "contributions": np.full(36, 18.0),
    }


@pytest.fixture()
def Li57Si64(data_path):
    traj = exma.read_xyz(data_path / "Li57Si64.xyz")
    traj[0].box = np.full(3, 12.901880)
    return {
        "trajectory": traj,
        "bonded": 1.0,
        "isolated": 0.0,
        "contributions": np.full(57, 18.0),
    }


@pytest.fixture()
def Li128Si64(data_path):
    traj = exma.read_xyz(data_path / "Li128Si64.xyz")
    traj[0].box = np.full(3, 14.754506)
    return {
        "trajectory": traj,
        "bonded": 0.9375,
        "isolated": 0.0625,
        "contributions": np.array(
            [
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                14.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                14.0,
                14.0,
                14.0,
                10.0,
                18.0,
                18.0,
                14.0,
                15.0,
                18.0,
                18.0,
                18.0,
                15.0,
                12.0,
                18.0,
                18.0,
                10.0,
                14.0,
                18.0,
                18.0,
                14.0,
                18.0,
                18.0,
                14.0,
                18.0,
                18.0,
                18.0,
                14.0,
                18.0,
                18.0,
                18.0,
                15.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                14.0,
                18.0,
                18.0,
                14.0,
                18.0,
                14.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                14.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                14.0,
                10.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                15.0,
                18.0,
                10.0,
                15.0,
                18.0,
                18.0,
                18.0,
                12.0,
                18.0,
                18.0,
                18.0,
                18.0,
                14.0,
                18.0,
                15.0,
                14.0,
                18.0,
                18.0,
                15.0,
                18.0,
                18.0,
                18.0,
                18.0,
                15.0,
                18.0,
                18.0,
                18.0,
                14.0,
                18.0,
                18.0,
                12.0,
                18.0,
                18.0,
                18.0,
                18.0,
                18.0,
                10.0,
                18.0,
            ]
        ),
    }


@pytest.fixture()
def Li210Si64(data_path):
    traj = exma.read_xyz(data_path / "Li210Si64.xyz")
    traj[0].box = np.full(3, 16.514473)
    return {
        "trajectory": traj,
        "bonded": 0.375,
        "isolated": 0.625,
        "contributions": np.array(
            [
                12.0,
                6.0,
                12.0,
                6.0,
                14.0,
                10.0,
                6.0,
                12.0,
                9.0,
                6.0,
                14.0,
                6.0,
                15.0,
                10.0,
                9.0,
                10.0,
                12.0,
                6.0,
                6.0,
                10.0,
                12.0,
                12.0,
                10.0,
                6.0,
                6.0,
                10.0,
                10.0,
                10.0,
                12.0,
                6.0,
                15.0,
                6.0,
                12.0,
                12.0,
                12.0,
                10.0,
                12.0,
                14.0,
                12.0,
                15.0,
                18.0,
                6.0,
                10.0,
                12.0,
                6.0,
                10.0,
                6.0,
                10.0,
                10.0,
                6.0,
                9.0,
                10.0,
                6.0,
                10.0,
                6.0,
                10.0,
                18.0,
                14.0,
                9.0,
                14.0,
                8.4,
                10.0,
                12.0,
                6.0,
                10.0,
                18.0,
                10.0,
                10.0,
                6.0,
                12.0,
                15.6,
                6.0,
                6.0,
                10.0,
                10.0,
                9.0,
                6.0,
                10.0,
                14.0,
                6.0,
                10.0,
                9.0,
                6.0,
                6.0,
                10.0,
                18.0,
                14.0,
                6.0,
                14.0,
                6.0,
                6.0,
                9.0,
                10.0,
                6.0,
                12.0,
                14.0,
                10.0,
                6.0,
                10.0,
                10.0,
                10.0,
                10.0,
                6.0,
                10.0,
                6.0,
                6.0,
                10.0,
                12.0,
                6.0,
                10.0,
                10.0,
                12.0,
                12.0,
                10.0,
                12.0,
                10.0,
                6.0,
                10.0,
                14.0,
                6.0,
                6.0,
                10.8,
                10.0,
                6.0,
                6.0,
                6.0,
                12.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                15.0,
                10.0,
                14.0,
                10.0,
                10.0,
                10.0,
                10.0,
                6.0,
                10.0,
                10.0,
                6.0,
                12.0,
                10.0,
                6.0,
                10.0,
                6.0,
                6.0,
                6.0,
                15.6,
                10.0,
                12.0,
                6.0,
                6.0,
                14.0,
                12.0,
                10.0,
                12.0,
                6.0,
                6.0,
                10.0,
                6.0,
                6.0,
                14.0,
                6.0,
                6.0,
                6.0,
                12.0,
                15.0,
                10.0,
                9.0,
                6.0,
                14.0,
                14.0,
                10.0,
                9.0,
                14.0,
                12.0,
                6.0,
                10.0,
                6.0,
                6.0,
                6.0,
                10.0,
                10.0,
                10.0,
                10.0,
                6.0,
                12.0,
                10.0,
                9.0,
                6.0,
                12.0,
                9.0,
                6.0,
                6.0,
                14.0,
                18.0,
                6.0,
                12.0,
                6.0,
                15.0,
                12.0,
                6.0,
                15.0,
                10.0,
                18.0,
                6.0,
                12.0,
            ]
        ),
    }


@pytest.fixture()
def Li240Si64(data_path):
    traj = exma.read_xyz(data_path / "Li240Si64.xyz")
    traj[0].box = np.full(3, 17.099661)
    return {
        "trajectory": traj,
        "bonded": 0.109375,
        "isolated": 0.890625,
        "contributions": np.array(
            [
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                12.0,
                6.0,
                6.0,
                10.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                10.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                10.0,
                6.0,
                6.0,
                12.0,
                10.0,
                6.0,
                9.0,
                10.0,
                10.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                10.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                12.0,
                6.0,
                10.0,
                10.0,
                6.0,
                10.0,
                6.0,
                10.0,
                12.0,
                6.0,
                6.0,
                6.0,
                6.0,
                10.0,
                6.0,
                9.0,
                10.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                10.0,
                6.0,
                10.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                10.0,
                6.0,
                9.0,
                6.0,
                6.0,
                10.0,
                6.0,
                6.0,
                15.0,
                12.0,
                6.0,
                6.0,
                6.0,
                6.0,
                10.0,
                10.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                10.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                10.0,
                6.0,
                10.0,
                6.0,
                6.0,
                6.0,
                10.0,
                6.0,
                6.0,
                10.0,
                10.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                10.0,
                10.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                10.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                10.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                10.0,
                6.0,
                10.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                10.0,
                6.0,
                12.0,
                6.0,
                6.0,
                10.0,
                6.0,
                14.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                12.0,
                6.0,
                6.0,
                6.0,
                6.0,
                12.0,
                9.0,
                10.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                6.0,
                12.0,
            ]
        ),
    }
